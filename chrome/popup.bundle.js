import{a as o,i as l,o as i}from"./util-CtUzdBzx.js";function r(e,t){t=="no-connect"?e.classList.add("no-conect"):e.classList.remove("no-conect"),e.innerHTML=`
        <p>
            Video Seleccionado
            <img src='${a.favIconUrl}' crossorigin="anonymous" class="data-save-img-icon" />
        </p>
        <img src=${a.imgCover} class='img-option'> 
    `}function m(e){dataVideos.innerHTML=e.map(t=>`<img class='img-option' tabId='${t.tabId}' imgNumber="${t.number}" src="${t.img}" > `).join("")}function g(){let e={selected:!1};Object.keys(a).length!=0&&(e={selected:!0}),chrome.tabs.query({url:["https://ahiseve.vercel.app/*","http://localhost:4321/*"]},t=>{t.forEach(n=>{o(n.id,{cmd:i.RESULT_CHECK_ELEMENT_VIDEO_SELECTED,data:e})})})}let a={tabId:"",imgNumber:"",imgCover:"",favIconUrl:""},c=localStorage.getItem("dataG");c&&(a=JSON.parse(c),o(parseInt(a.tabId),{cmd:i.CHECK_CONNECTION}).then(e=>{e.message=="connected"&&r(dataSaveVideo)}).catch(e=>{console.log("Error al enviar mensaje:",e),r(dataSaveVideo,"no-connect")})),setTimeout(()=>{chrome.tabs.query({},function(e){try{dataTabs.innerHTML=e.map(t=>`<div class="tab-title" dataID='${t.id}'>
                    <img src='${t.favIconUrl}' crossorigin="anonymous" /> ${t.title}
                </div >`).join("")}catch(t){console.log(t)}})},100),dataTabs.addEventListener("click",e=>{if(e.target.classList.contains("tab-title")){let t=e.target.getAttribute("dataID");window.location.href="#dataVideos",o(parseInt(t),{cmd:i.GET_VIDEOS_DATA}).then(n=>{console.log("Mensaje enviado:",n)}).catch(n=>{console.log("Error al enviar mensaje:",n),chrome.scripting.executeScript({target:{tabId:parseInt(t),allFrames:!0},files:["content.bundle.js"]}).then(()=>{console.log("script injected in all jaus"),o(parseInt(t),{cmd:i.GET_VIDEOS_DATA}).then(s=>{console.log("Mensaje enviado:",s)}).catch(s=>{console.log("Error al enviar mensaje 2:",s)})})})}}),dataVideos.addEventListener("click",e=>{if(e.target.classList.contains("img-option")){const t=()=>{a.imgNumber=e.target.getAttribute("imgNumber"),a.imgCover=e.target.src,a.tabId=e.target.getAttribute("tabId"),chrome.tabs.get(parseInt(e.target.getAttribute("tabId")),function(n){a.favIconUrl=n.favIconUrl,localStorage.setItem("dataG",JSON.stringify(a)),l({cmd:"updateDataG",data:a}),r(dataSaveVideo),o(parseInt(a.tabId),{cmd:i.ADD_EVENTS_ELEMENT,data:{idNumber:a.imgNumber}}),g()})};a.tabId==""?t():o(parseInt(a.tabId),{cmd:i.REMOVE_EVENTS_ELEMENTS,data:{idNumber:a.imgNumber}}).then(n=>{n.status=="ok"&&t()}).catch(n=>{console.log("error remove",n),t()})}});let E=[],d=[];chrome.runtime.onMessage.addListener(function(e,t,n){e.cmd=="responseIMGS"?(d.push(e.data.map(s=>({...s,tabId:t.tab.id}))),m(d.flat())):e.cmd=="ElementVideo"&&E.push(e.data.id),n("no se encontro coincidencia")});
